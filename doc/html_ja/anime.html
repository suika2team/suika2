<!DOCTYPE html>
<html lang="ja-JP">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>OpenNovel マニュアル</title>
  <link rel="stylesheet" href="../css/style.css">
</head>
<body>

<h1>アニメの基本</h1>

<p>
  <a href="referene.html#anime"><code>@anime</code></a> コマンドでアニメスクリプトを再生できます。
  アニメの内容は、ストーリーファイルではなく、別なテキストファイルに記述します。
</p>
<p>
  メッセージボックスを1秒かけて右側に100pxずらすには、下記のアニメファイルを作成し、<code>script/anime</code>フォルダに入れます。
</p>
<pre><code>move {
    layer:  msg;
    start:  0.0;
    end:    1.0;
    from-x: +0;
    from-y: +0;
    from-a: 255;
    to-x:   +100;
    to-y:   +0;
    to-a:   255;
}</code></pre>

<h2>レイヤーの構成</h2>
<p>
  現時点では上から順に下記の構成です。
</p>
<pre><code>text8
text7
text6
text5
text4
text3
text2
text1 

chf  (キャラ顔)
name (名前ボックス)
msg  (メッセージボックス)

effect4
effect3
effect2
effect1

chc  (中央キャラ)
chrc (右中キャラ)
chr  (右キャラ)
chlc (左中キャラ)
chl  (左キャラ)
chb  (背面キャラ)

effect8
effect7
effect6
effect5
 
bg2
bg   (背景)</code></pre>

<p>
  <code>effect1</code> から <code>effect4</code> は、雨のアニメーションや、色味を加えるのに使えます。
  <code>text1</code> から <code>text8</code> は、<code>@text</code> 命令でテキストを描画するのに使えます。
</p>

<h2>アニメでの拡大、縮小、回転</h2>
<pre><code>test1 {
    layer:  effect1;
 
    start:  0.0;
    end:    3.0;

    from-x: 0;
    from-y: 400;
    from-a: 255;

    to-x:   0;
    to-y:   400;
    to-a:   255;

    # 画像内での拡大縮小・回転の中心座標
    center-x: 600;
    center-y: 100;

    # 拡大率 
    from-scale-x: 1.0;
    from-scale-y: 1.0;
    to-scale-x:   2.0;
    to-scale-y:   2.0;
 
    # 回転(プラスだと右回り、マイナスだと左回り)
    from-rotate:  0.0;
    to-rotate:    -360;
}
test2 {
    layer:  effect1;

    start:  3.0;
    end:    6.0;

    from-x: 0;
    from-y: 400;
    from-a: 255;

    to-x:   0;
    to-y:   400;
    to-a:   255;

    center-x: 600;
    center-y: 100;

    from-scale-x: 2.0;
    to-scale-x:   1.0;

    from-scale-y: 2.0;
    to-scale-y:   1.0;

    from-rotate: -360;
    to-rotate:   0;
}</code></pre>

<h2>アニメのリセット</h2>
<p>
  例えば拡大した後、縮小のアニメファイルを別で用意するのも、画面を元に戻す一つの手段です。
  しかし、アニメーションを使わずパッと一気に戻すのであれば、@anime reset を利用することもできます。
</p>
<pre><code>@anime reset layer-bg,xy,scale,rotate
@anime reset layer-chc,xy,scale,rotate
@anime reset layer-all,xy,scale,rotate</code></pre>

<p>
  <code>layer-bg</code> だと背景、<code>layer-chc</code> だと立ち絵中央、<code>layer-all</code> だと全てのレイヤーをリセットし、アニメ前の状態に戻します。
  <code>xy</code> はx位置/y位置、<code>scale</code> は拡大率、<code>rotate</code> は回転のことを指し、単体のみでも複数でも指定できます。
  例えば下のように書くと、背景の拡大率のみをリセットすることが可能です。
</p>
<pre><code>@anime reset layer-bg,scale</code></pre>

<h2>アニメのクリア</h2>
<p>
  特定のレイヤーのアニメを強制終了するには、
</p>
<pre><code>@anime clear layer-bg,layer-chc</code></pre>
<p>
  のように停止したいレイヤーを併記します。
  すべてのアニメが完了するまで待機するには、
</p>
<pre><code>@anime finish-all</code></pre>
<p>
  とします。
  すべてのアニメを強制終了するには、
</p>
<pre><code>@anime clear layer-all</code></pre>
<p>
  とします。
</p>

</body>
</html>
