<!DOCTYPE html>
<html lang="ja-JP">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>Suika2 By OpenNovel.org マニュアル</title>
  <link rel="stylesheet" href="../css/style.css">
  <style>
    code { background-color: #CF9; }
  </style>
</head>
<body>

<h1>メニュー画面の作り方</h1>
<p>
	メニュー画面を作っていくための手順を載せています。
</p>

<h2>まずはじめに</h2>
<p>
	サンプルゲームの中身を見ていきましょう。
</p>

<h3>タイトル画面の呼び出し箇所</h3>
<p>
	<code>story/story.txt</code> の中で、<code>@menu title.txt</code> と書いてある行を探してください。
	これがメニュー画面の呼び出しです。
	タイトル画面はメニュースクリプトを使って実現されています。
</p>
<p>
	<code>title.txt</code> というのは、<code>script/menu</code> フォルダに入っている <code>title.txt</code> のことです。
</p>

<h3>title.txt の中身</h3>
<p>
	<code>script/menu/title.txt</code> など、メニュースクリプトを開いてみてください。
	まず先頭に、
</p>
<pre><code># このファイルの基本設定
global {
    # 下記の画像を使用する
    base:   title/idle.png;
    idle:   title/idle.png;
    hover:  title/hover.png;
    active: title/hover.png;

    # フェードイン時間(秒)
    fadein: 0.2;

    # フェードアウト時間(秒)
    fadeout: 0.2;
}</code></pre>
<p>
	と書かれています。これの意味は下記のとおりです。
</p>

<table>
	<thead>
		<tr>
			<th>指定名</th>
			<th>意味</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>base</td>
			<td>
				一番背景となるレイヤーの指定。
				noneを指定するとゲームのステージ（背景、キャラ）が表示される。
				画像を指定すると画像が表示される。
			</td>
		</tr>
		<tr>
			<td>idle</td>
			<td>
				ボタンがマウスでポイントされていないときに表示する画像。
			</td>
		</tr>
		<tr>
			<td>hover</td>
			<td>
				ボタンがマウスでポイントされた時に表示する画像。
			</td>
		</tr>
		<tr>
			<td>active</td>
			<td>
				単純なタイトル画面では使いません。
				適当にidleやhoverと同じ画像を使っておきます。
			</td>
		</tr>
		<tr>
			<td>fadein</td>
			<td>フェードイン時間(秒)</td>
		</tr>
		<tr>
			<td>fadeout</td>
			<td>フェードアウト時間(秒)</td>
		</tr>
	</tbody>
</table>

<h3>ボタン画像の準備について</h3>
<ul>
	<li>他のエンジンと違って、個々の小さなボタンの画像を使いません</li>
	<li>代わりに、画面全体の中にボタンを配置した画像を利用します</li>
	<li>このデータを作るには、画像編集ソフトやペイントソフトのレイヤー機能を使います</li>
</ul>

<h3>title.txt ファイルの構造</h3>
<p>
	<code>title.txt</code> ファイルの続きについて見ていきます。
	大まかに見ると4つのボタンについて書かれています。
	なんとなく眺めてみると、次の構造になっていることがわかります。
</p>
<pre><code>START {
    ...
}

LOAD {
    ....
}

CONFIG {
    ...
}

QUIT {
    ...
}</code></pre>

<h3>START ボタンの中身</h3>
<p>
	ここで START ボタンの中をよく見ていきます。
</p>
<pre><code># STARTボタン
START {
    # 種類:ラベルへジャンプ
    type: goto;

    # ジャンプ先のラベル
    label: START;

    # 座標とサイズ
    x: 2;
    y: 495;
    width: 314;
    height: 192;

    # ポイントされたときの効果音
    pointse: btn-change.ogg;

    # クリックされたときの効果音
    clickse: click.ogg;
}</code></pre>

<p>
	わかる部分、わからない部分があると思います。さらに詳しく見ていきましょう。
</p>

<h3>クリックされたらラベルへジャンプ</h3>
<p>
	<code>type: goto;</code> というのは、このボタンが押されたときに、
	「ストーリーファイルどこかのラベルにジャンプする」、
	という意味です。
	ラベルというのは、シナリオの中で、`:` から始まる行のことです。
</p>
<p>
	<code>label: START;</code> というのは、このボタンが押されたときに、
	「ストーリーファイルの <code>:START</code> という行にジャンプする」、
	という意味です。
</p>

<h3>座標とサイズ</h3>
<p>
	座標とサイズですが、これは <code>Photoshop</code> や <code>CLIP STUDIO PAINT</code> などのツールで、
	ボタンの位置とサイズを確認して書いてください。
</p>

<h3>これでOK</h3>
<p>
	たったこれだけです。意外と難しくなかった、という感想を持たれたと思います。
</p>

<h2>ボタンを増やすには？</h2>
<ul>
	<li>START { ... } のブロックをコピーして、新しいブロックを作ってみましょう</li>
	<li>コピー先の START の部分には自分で新しい名前を付けてください</li>
	<li>アルファベットならなんでもいいです。(実を言うとSTARTが2つあってもそのまま動きます)</li>
</ul>

<h2>ヒストリーやセーブ画面での調整</h2>
<p>
	セーブ・ロード・ヒストリーのスロット内の文字に、灰色のふちどりが生じることがあります。
	この場合、スロットに以下のような背景色を追加すると解決できます。
</p>
<pre><code># 背景色
clear-r: 255;
clear-g: 255;
clear-b: 255;</code></pre>
<p>
	ファイル記載例
</p>
<pre><code># セーブデータ1番目
SAVESLOT1 {
   # 種類:セーブ
   type: save;

   # セーブデータ番号0
   index: 0;

   # 背景色
   clear-r: 255;
   clear-g: 255;
   clear-b: 255;

   # 座標とサイズ
   x: 167;
   y: 153;
   width: 950;
   height: 162;

   # 画像とテキストのマージン
   margin: 20;

   # ポイントされたときの効果音
   pointse: btn-change.ogg;

   # クリックされたときの効果音
   clickse: click.ogg;

}</code></pre>

</body>
</html>
